<div class="productos-layout card-appear">
  <div class="productos-header">
    <h1 class="h1 productos-titulo">Productos</h1>

    <div class="productos-acciones">
      <a class="btn-secondary" routerLink="/presupuestos">Ver presupuestos</a>
      <button class="btn-primary" routerLink="/presupuestos/nuevo">
        Nuevo presupuesto
      </button>
      <button class="btn-logout" (click)="logout()">Cerrar sesi贸n</button>
    </div>
  </div>

  <div class="productos-busqueda">
    <input
      type="text"
      class="input"
      placeholder="Buscar producto o c贸digo..."
      [(ngModel)]="q"
      (keyup.enter)="fetch()"
    />
    <button class="btn-primary" style="width: auto" (click)="fetch()">
      Buscar
    </button>
  </div>

  <!-- Resto de tu formulario y tabla originales -->
  <ng-container *ngIf="!loading">
    <div
      class="productos-tabla"
      *ngIf="data.length > 0; else sinResultados"
    >
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>C贸digo</th>
            <th>Nombre</th>
            <th>Descripci贸n</th>
            <th class="text-end">Precio</th>
            <th class="text-end">Stock</th>
            <th>Estado</th>
            <th class="text-end">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of data">
            <td>{{ p.id }}</td>
            <td>{{ p.codigo }}</td>
            <td>{{ p.nombre }}</td>
            <td>{{ p.descripcion }}</td>
            <td class="text-end">{{ p.precio | number: '1.2-2' }}</td>
            <td class="text-end">{{ p.stock }}</td>
            <td>
              <span
                [class.text-bg-success]="p.activo"
                [class.text-bg-secondary]="!p.activo"
                style="padding: 4px 8px; border-radius: 8px; font-size: 12px"
              >
                {{ p.activo ? 'Activo' : 'Inactivo' }}
              </span>
            </td>
            <td class="text-end acciones">
              <button
                class="btn-accion blue"
                *ngIf="auth.canEdit()"
                (click)="actualizarStock(p)"
              >
                Stock
              </button>
              <button
                class="btn-accion gray"
                *ngIf="auth.canEdit()"
                (click)="editar(p)"
              >
                Editar
              </button>
              <button
                class="btn-accion red"
                *ngIf="auth.canDelete()"
                (click)="eliminar(p)"
              >
                Eliminar
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <ng-template #sinResultados>
      <div class="text-muted" style="text-align: center">Sin resultados.</div>
    </ng-template>
  </ng-container>
</div>
